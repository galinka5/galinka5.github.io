<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Test XANO endpoints</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="nofollow">
  <link rel="stylesheet" href="css/styles.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>

<body>
  <p><small>Version 1.3.7</small></p>
  <h1>XANO API tests</h1>
  <section class="row">
    <div class="col col-12 col-md-4">
      <h3>Sign up</h3>
      <div>
        <input type="text" name="name1" id="name1" placeholder="Name">
      </div>
      <div>
        <input type="email" name="login1" id="login1" placeholder="Email">
      </div>
      <div>
        <input type="password" name="password1" id="password1" placeholder="Password">
      </div>
      <div>
        <button onclick="signupClick()">Sign up</button>
      </div>
    </div>
    <div class="col  col-12 col-md-4 mt-3 mt-md-0">
      <h3>Login</h3>
      <div>
        <input type="email" name="login2" id="login2" placeholder="Email">
      </div>
      <div>
        <input type="password" name="password2" id="password2" placeholder="Password">
      </div>
      <div>
        <button onclick="loginClick()">Login</button>
        <button disabled onclick="getInfoClick()" id="getInfoBtn">Get info</button>
      </div>
    </div>
    <div class="col col-12 col-md-4 mt-3 mt-md-0">
      <h3>Social Bar</h3>
      <div class="socail-bar">
        <div class="social-bar-btn" onclick="googleClick()"><img src="/assets/images1/google.svg"></div>
        <div class="social-bar-btn" onclick="facebookClick()"><img src="/assets/images1/facebook.svg"></div>
        <div class="social-bar-btn" onclick="linkedinClick()"><img src="/assets/images1/linkedIn.svg"></div>
      </div>
    </div>
  </section>
  <section>
    <p class="debug-result" id="debug"></p>
  </section>

  <script src="/js/main.js?128"></script>
  <script>

    $(document).ready(function () {
      var urlParams = new URLSearchParams(window.location.search);
      const code = urlParams.get('code');
      console.log(code);
      if (code) {
        const scope = urlParams.get('scope');
        if (scope && scope.indexOf('www.googleapis.com') >= 0) { //return after google signup
          googleContinue(code);
        }
        if (!scope) {  //return after linkedin signup
          linkedinContinue(code);
        }
      }
    });

    function signupClick() {
      signup($('#name1').val(), $('#login1').val(), $('#password1').val());
    }

    function loginClick() {
      login($('#login2').val(), $('#password2').val())
        .then(data => {
          console.log(data);
          $('#getInfoBtn').prop("disabled", false);
          debug(`OK on login: ${data.authToken}`);
          gotoAdminPage();
        })
        .catch(error => {
          console.log(error);
          debug(`Error on login: ${error.responseText}`, true);
        })
    }

    function getInfoClick() {
      getInfo();
    }

    function linkedinInitClick() {
      linkedinInit();
    }

    function linkedinSignupClick() {
      linkedinSignup();
    }

    function facebookClick() {
      facebookInit();
    }

    function linkedinClick() {
      linkedinInit();
    }

    function googleClick() {
      googleInit();
    }
  </script>
</body>

</html>